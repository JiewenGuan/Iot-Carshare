
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>External Input Code Documentation &#8212; IOT_car_share_assignment 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Testing Code Documentation" href="testing_code.html" />
    <link rel="prev" title="Master Code Documentation" href="master_code.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="external-input-code-documentation">
<h1>External Input Code Documentation<a class="headerlink" href="#external-input-code-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="facecapture-py">
<h2>facecapture.py<a class="headerlink" href="#facecapture-py" title="Permalink to this headline">¶</a></h2>
<p>Captures a set of faces to be encoded.</p>
<span class="target" id="module-AgentPi.facecapture"></span><p>This module is responsible for capturing a face for a users facerecognition.</p>
<dl class="py class">
<dt id="AgentPi.facecapture.FaceCapture">
<em class="property">class </em><code class="sig-prename descclassname">AgentPi.facecapture.</code><code class="sig-name descname">FaceCapture</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">data_folder</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#AgentPi.facecapture.FaceCapture" title="Permalink to this definition">¶</a></dt>
<dd><p>If successful, it stores the set of faces in the passed in location. 
The instantiation is passed in the following parameters
name = (string) the name of the person intended to be added
data_folder = (string) the folder to store face sets in.</p>
<dl class="py method">
<dt id="AgentPi.facecapture.FaceCapture.capture_face">
<code class="sig-name descname">capture_face</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#AgentPi.facecapture.FaceCapture.capture_face" title="Permalink to this definition">¶</a></dt>
<dd><p>The only entry point for this class - attempts to record video and store
the resulting images in a folder based on the name variable.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="faceencoder-py">
<h2>faceencoder.py<a class="headerlink" href="#faceencoder-py" title="Permalink to this headline">¶</a></h2>
<p>Encodes the face sets, or re-encodes them if previously encoded.</p>
<span class="target" id="module-AgentPi.faceencoder"></span><p>This module is responsible for encoding the dataset of face captures.
It should be called either after a user has been added to the face collection,
or if the database becomes large, periodically whenever processing time is available.</p>
<dl class="py class">
<dt id="AgentPi.faceencoder.FaceEncoder">
<em class="property">class </em><code class="sig-prename descclassname">AgentPi.faceencoder.</code><code class="sig-name descname">FaceEncoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">encoding_file</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#AgentPi.faceencoder.FaceEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepts the dataset file location, and the name of the output file.</p>
<dl class="py method">
<dt id="AgentPi.faceencoder.FaceEncoder.encode_faces">
<code class="sig-name descname">encode_faces</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#AgentPi.faceencoder.FaceEncoder.encode_faces" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiating method - accepts nothing and returns a bool based on the outcome of encoding.
This method has a significant time cost factor.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="facerecognition-py">
<h2>facerecognition.py<a class="headerlink" href="#facerecognition-py" title="Permalink to this headline">¶</a></h2>
<p>Captures the user’s face and attempts to determine if there is a profile for the user in the database on the agent.</p>
<span class="target" id="module-AgentPi.facerecognition"></span><p>This class is responsible for recognising the face captured by the device. It does
so by checking the presented face against the locally stored encodings, returning
the encoded name which should be the user token to be sent to the MasterPi for 
validation.</p>
<dl class="py class">
<dt id="AgentPi.facerecognition.FaceRecognition">
<em class="property">class </em><code class="sig-prename descclassname">AgentPi.facerecognition.</code><code class="sig-name descname">FaceRecognition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pickle_file</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#AgentPi.facerecognition.FaceRecognition" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is instantiated and the recognise_face() method called to recognise a face
if it is stored in the pickle encoding. It accepts a path to the pickle file the 
resolution of the video feed.</p>
<dl class="py method">
<dt id="AgentPi.facerecognition.FaceRecognition.recognise_face">
<code class="sig-name descname">recognise_face</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#AgentPi.facerecognition.FaceRecognition.recognise_face" title="Permalink to this definition">¶</a></dt>
<dd><p>The detection method is set as hog due to device limitations. See module
comments for further details.
It returns a string with the token for a valid recogition, or None for 
any other result including errors.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="qrreader-py">
<h2>qrreader.py<a class="headerlink" href="#qrreader-py" title="Permalink to this headline">¶</a></h2>
<p>Captures any QR codes and validated their structure for use by an engineer when locking a vehicle.</p>
<span class="target" id="module-AgentPi.qrreader"></span><p>This module performs the functions associated with QR code
reading. It has one class <a class="reference internal" href="#AgentPi.qrreader.QRReader" title="AgentPi.qrreader.QRReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRReader</span></code></a> that consists of two 
functions - <code class="xref py py-func docutils literal notranslate"><span class="pre">read_qr_code()</span></code> which uses the camera to search
for QR codes, and <code class="xref py py-func docutils literal notranslate"><span class="pre">validate_qr_code()</span></code> which ensures the QR Code
is of the correct format before been returned.</p>
<dl class="py class">
<dt id="AgentPi.qrreader.QRReader">
<em class="property">class </em><code class="sig-prename descclassname">AgentPi.qrreader.</code><code class="sig-name descname">QRReader</code><a class="headerlink" href="#AgentPi.qrreader.QRReader" title="Permalink to this definition">¶</a></dt>
<dd><p>The QRReader class consists of two functions, <a class="reference internal" href="#AgentPi.qrreader.QRReader.read_qr_code" title="AgentPi.qrreader.QRReader.read_qr_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_qr_code()</span></code></a> which is publicly
callable, and <a class="reference internal" href="#AgentPi.qrreader.QRReader.validate_qr_code" title="AgentPi.qrreader.QRReader.validate_qr_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate_qr_code()</span></code></a> which is called to validate
any codes that are found.</p>
<dl class="py method">
<dt id="AgentPi.qrreader.QRReader.read_qr_code">
<code class="sig-name descname">read_qr_code</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AgentPi.qrreader.QRReader.read_qr_code" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions initialises the camera and then searches for QR codes. 
Any codes that are found are incrementally passed to <a class="reference internal" href="#AgentPi.qrreader.QRReader.validate_qr_code" title="AgentPi.qrreader.QRReader.validate_qr_code"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate_qr_code()</span></code></a> 
which returns the code to be returned to the calling function,
or False if the code is invalid.</p>
</dd></dl>

<dl class="py method">
<dt id="AgentPi.qrreader.QRReader.validate_qr_code">
<code class="sig-name descname">validate_qr_code</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">qr_code</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#AgentPi.qrreader.QRReader.validate_qr_code" title="Permalink to this definition">¶</a></dt>
<dd><p>This function validates a QR code that has been passed to it
by checking if the code has the correct structure and if needed,
extracts the relevant data and returns the data, or returns 
False if the code is invalid.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="bluetoothlistener-py">
<h2>bluetoothlistener.py<a class="headerlink" href="#bluetoothlistener-py" title="Permalink to this headline">¶</a></h2>
<p>Peforms functions associated with listening for engineer bluetooth devices when an engineer attempts to access a vehicle.</p>
<span class="target" id="module-AgentPi.bluetoothlistener"></span><p>This module performs the functions associated with the
bluetooth recognition of users. It serves this function
by periodically or (relatively) instantaneously collecting the MAC addresses 
of active devices that are in range of the Agent
device, comparing this to a previously collected set
of devices in the case of periodic testing, and then polls the master pi for any valid
engineer appointment for the vehicle ID.</p>
<dl class="py class">
<dt id="AgentPi.bluetoothlistener.BluetoothListenerEngineer">
<em class="property">class </em><code class="sig-prename descclassname">AgentPi.bluetoothlistener.</code><code class="sig-name descname">BluetoothListenerEngineer</code><a class="headerlink" href="#AgentPi.bluetoothlistener.BluetoothListenerEngineer" title="Permalink to this definition">¶</a></dt>
<dd><p>This class encapsulates the functions required to 
listen for bluetooth devices. It is instantiated
with no parameters.
Its primary functions <a class="reference internal" href="#AgentPi.bluetoothlistener.BluetoothListenerEngineer.listen_bluetooth" title="AgentPi.bluetoothlistener.BluetoothListenerEngineer.listen_bluetooth"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen_bluetooth()</span></code></a> (accepts 
one paramater as an int which is the interval 
time in seconds between listen events) and 
catch_bluetooth (no defined time) return a set of 
devices that have persisted for at least the 
defined time. The logic underpinning this is that 
many devices will move within proximity but less 
will persist - those that persist may be an engineer.
For this to return, the device must be discoverable.</p>
<dl class="py method">
<dt id="AgentPi.bluetoothlistener.BluetoothListenerEngineer.catch_bluetooth">
<code class="sig-name descname">catch_bluetooth</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#AgentPi.bluetoothlistener.BluetoothListenerEngineer.catch_bluetooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Called to return a set of bluetooth MAC addresses
that were detetected during the predetermined 
detection period.</p>
</dd></dl>

<dl class="py method">
<dt id="AgentPi.bluetoothlistener.BluetoothListenerEngineer.listen_bluetooth">
<code class="sig-name descname">listen_bluetooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">listen_interval</span></em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#AgentPi.bluetoothlistener.BluetoothListenerEngineer.listen_bluetooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Called to return a set of persisting bluetooth 
MAC addresses based on the <code class="xref py py-attr docutils literal notranslate"><span class="pre">listen_interval</span></code> parameter.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">IOT_car_share_assignment</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent_code.html">Agent Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="master_code.html">Master Code Documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">External Input Code Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#facecapture-py">facecapture.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#faceencoder-py">faceencoder.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#facerecognition-py">facerecognition.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qrreader-py">qrreader.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bluetoothlistener-py">bluetoothlistener.py</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="testing_code.html">Testing Code Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="master_code.html" title="previous chapter">Master Code Documentation</a></li>
      <li>Next: <a href="testing_code.html" title="next chapter">Testing Code Documentation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Cameron Bolton & Jiewen Guan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/fr_code.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>